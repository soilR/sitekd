---
title: "Interpretation of redox measurements"
author: "Kristof Dorau"
date: '2021-02-09'
slug: null
draft: true
categories: []
tags:
- Introduction
- Interpretation
subtitle: ''
summary: 'Rules of thumb when evaluating and analyzing redox data'
authors: []
featured: no
image:
  caption: 
  focal_point: Smart
  preview_only: no
projects: []
editor_options: 
  chunk_output_type: console
---




*The post was last updated on `r format(Sys.Date(), "%Y-%m-%d")`.*

<style>
p.caption {
  font-size: 0.6em;
}
</style>


```{r echo = FALSE, message = FALSE, warning = F}

knitr::opts_chunk$set(warning = F, echo = F, error = F, message = F)

library(tidyverse)
library(widgetframe)
library(timevis)
library(rmarkdown)
library(kableExtra)

## The theme must be in FRONT (!) of all ggplot or it will be overwritten
my_theme <- theme(
  panel.background = element_rect(fill = "white", color = "black"),
  panel.grid.major = element_blank(), 
  panel.grid.minor = element_blank(), 
  panel.border = element_blank())


```

As outlined in the introduction, redox potentials have a huge importance in soils and sediments since the data enables to obtain insights into particular processes that take place. Even though the measurement is very valuable, the interpretation is not so easy and people must be cautious. Hence, “measured values of E~H~ obtained from a Pt electrode thus have only qualitative significance in soils” (Sposito, 2016) and the application, “in common with so many other measurements in nature, is in their interpretation by a knowledgeable observer” (Bohn, 1971). 

Here are some rules of thumb:

* Only use integers values without a decimal place ❗ 
* Some authors argue that values up to 50 mV have little meaning. Thus, if one value is 480 mV and the other is 490 mV there is no actual difference between the measurements. Keep in mind that the E~H~ in soils ranges between -300 and +700 mV. 
* It is sometimes better to interpret the development of the E~H~ (is it increasing/decreasing; is the decrease straightforward or stopped) than only consider a snapshot in time. 
* Don't take individual readings from only one Pt electrode as valid. In most of our studies we employ at least **three individual electrodes per depth**.  Some authors suggest to use even eight to ten electrodes per depth (Cogger et al. 1992).
* Working with the mean and the standard deviation from a time series is good, but even better is to give information about the distribution of redox classes. 

I will illustrate the bullet points above in the following. The data is taken from our study site at Polder Speicherkoog ([see this post to see what the site features]()):

```{r echo = FALSE, message=FALSE}

koog <- readr::read_delim("data.csv", delim = ";",
                          col_types = cols(
                          # col_datetime parse the input character representations to a date/time
                          # POSIXct stores seconds since UNIX epoch (+some other data)
                          # POSIXlt stores a list of day, month, year, hour, etc.
                          date = col_datetime(format = "%d.%m.%Y %T")
                        ))

# Adds + 207 mV to all columns that start with EH
koog <- koog %>%
  mutate(across(contains("EH"), ~. +207)) # The tilde is used for a statistical model (left side is response and right is explanatory variables)

# Adds a timestamp for daily, monthly, and yearly data aggregation
koog <- koog %>%
  mutate(day = as.Date(format(date, "%Y-%m-%d")),
         month = format(date, "%m"),
         year = format(date, "%Y")
         )

# Aggregate the hourly data into daily data
dh_daily <- koog %>%
  group_by(day, month, year) %>%
  summarise_if(is.numeric, mean, na.rm = T) # only summarizes numeric values by mean)

```

How can we account for spatial heterogeneity?

```{r}

# Include the clay lense and show how to deal with it. 
#Highlight a particular sequence, for example electrode 60b
dh_daily %>%
  janitor::clean_names() %>%
  select(day, year, contains("eh60")) %>%
  pivot_longer(cols = contains("eh60")) %>%
  ggplot(aes(day, value, group = name, color = ifelse(name == "eh60b", "Electrode 60b (clay lense)", "Two other electrodes"))) +
  geom_line(na.rm = T) +
  facet_wrap(~year, scales = "free_x") +
  scale_x_date(date_labels = "%m", date_breaks = "3 months") +
  scale_color_discrete(name = "Redox potential") +
  labs(
    title = "Electrode 60b measures lower EH throughout the years",
    x = "Month",
    y = expression(paste("E"[H], " (mV)"))
  ) + 
  my_theme

```

We can see that one electrode (60b) measures a lower E~H~ throughout the years, thus, averaging the data per depth might be partially misleading or at least, we loose some information. 

```{r}

dh_daily %>%
  ungroup() %>%
  janitor::clean_names() %>%
  select(contains("eh60")) %>%
  pivot_longer(cols = contains("eh60")) %>%
  ggplot(aes(name, value)) +
  ggdist::stat_halfeye(
    adjust = .5, 
    width = .6, 
    .width = 0, 
    justification = -.2, 
    color = "black"
  ) + 
  geom_boxplot(
    width = .15, 
    outlier.shape = NA
  ) +
  coord_cartesian(clip = "off") +
  stat_summary(fun = mean, shape = 21, fill = "red") +
  labs(
    x = "electrode",
    y = expression(E[H]~(mV))
  ) +
  my_theme


dh_daily %>%
  ungroup() %>%
  janitor::clean_names() %>%
  select(eh60a:eh60c) %>%
  summarise_all(.funs = mean, na.rm=T) %>%
  kableExtra::kable()

```

Boxplots are good and robust tools to visualize the distribution of data and in conjunction with the data behind the boxplot (e.g. by jittered points or as density distribution with the area within this example) even more powerful. Most of the data occurs under oxidizing conditions between 500 and 750 mV and and we can easily see, that the E~H~ for electrode 60b is lower with 260 mV compared with 440 (electrode 60a) and 410 (electrode 60c). This would be a good way to visualize the differences for electrodes from the same depth. 

Presumably --> clay lense is responsible 

Though, some of the information is lost on a temporal scale. 

